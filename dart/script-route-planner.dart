import "dart:typed_data" as z;import "dart:html" as AB;import "dart:js" as YB;import "dart:async" as mB;import "dart:math" as fC;import "dart:convert" as jD;class jE{static const String kE="Chrome";static const String lE="Firefox";static const String mE="Internet Explorer";static const String nE="Safari";final String RE;final String minimumVersion;const jE(this.RE,[this.minimumVersion]);}class oE{const oE();}class pE{final String name;const pE(this.name);}class qE{const qE();}class rE{const rE();}class kD{void cE(){BF();CF();DF();EF();FF();GF();HF();IF();}void BF(){AB.Element e=AB.querySelector('.close-jumbotron-button');AB.Element f=AB.querySelector('.open-jumbotron-button');if(e==null||f==null){return;}AB.Element b=AB.querySelector('.jumbotron');AB.Element c=AB.querySelector('.jumbotron-folded');e.onClick.listen((d){b.style.display='none';c.style.display='block';PD('closeJumbotron','1',expires:180);d.stopPropagation();});f.onClick.listen((d){b.style.display='block';c.style.display='none';PD('closeJumbotron','0',expires:180);d.stopPropagation();});if(HE('closeJumbotron')=='1'){b.style.display='none';c.style.display='block';}}void CF(){AB.Element d=AB.querySelector('.navbar-toggle-button');AB.Element b=AB.querySelector('.navbar-collapsible-block');bool c=false;var e=(JF){if(c){b.classes..add('in')..remove('collapse')..remove('collapsing');}else{b.classes..add('collapse')..remove('collapsing')..remove('in');b.style.height='0';}};b.onTransitionEnd.listen(e);d.onClick.listen((g){c=!c;b.classes..add('collapsing')..remove('collapse')..remove('in');if(c){int f=b.scrollHeight+1;b.style.height="${f}px";}else{b.style.height="0";}});}void DF(){List<AB.Node> f=AB.document.getElementsByTagName('span');DateTime g=new DateTime.now();Duration h=g.timeZoneOffset;List<String> i=const['Понедельник','Вторник','Среда','Четверг','Пятница','Суббота','Воскресенье'];List<String> j=const['января','февраля','марта','апреля','мая','июня','июля','августа','сентября','октября','ноября','декабря'];f.forEach((AB.Element c){String d=c.dataset['postDate'];if(d==null){return;}DateTime e=DateTime.parse(d);if(e==null){return;}DateTime b=e.add(h);c.text="${i[b.weekday-1]}, ${b.day} ${j[b.month-1]} ${b.year}" ", ${b.hour<10?'0':''}${b.hour}:${b.minute<10?'0':''}${b.minute}";});}void EF(){AB.ElementList c=AB.querySelectorAll('span.post-comments');if(c.length==0){return;}new mB.Timer.periodic(new Duration(microseconds:100),(g){if(c[0].text.startsWith('Считаем')){return;}g.cancel();c.forEach((AB.Element h){AB.Element d=h.querySelector('a');if(d==null){return;}d.text=d.text.replaceAllMapped(new RegExp('^(\\d+) комментариев\$'),(Match f){int b=int.parse(f[1]);if((b%100/10).round()!=1){int e=b%10;if(e==1){return '${b} комментарий';}else if(e>=2&&e<=4){return '${b} комментария';}}return f[0];});});});}void FF(){if(KF()){LF();}}bool KF(){final AB.NodeValidatorBuilder MF=new AB.NodeValidatorBuilder.common()..allowElement('span',attributes:['data-linenum']);AB.ElementList i=AB.querySelectorAll('pre > code.sourceCode');if(i.length>0){YB.JsObject k=YB.context['hljs'];i.forEach((AB.HtmlElement e){k.callMethod('highlightBlock',[e]);List<String> c=e.innerHtml.split('\n');RegExp l=new RegExp(r'<span[\s\S]*?>');RegExp n=new RegExp(r'</span>');List<String> f=[] ;for(int b=0;b<c.length; ++b){String d='<span class="line" data-linenum="${b+1}">';if(c[b]==''){d+= '&nbsp;';}else{String g=f.join('')+c[b];d+= g;Iterable<Match> j=l.allMatches(g);Iterable<Match> o=n.allMatches(g);f=[] ;for(int h=o.length;h<j.length; ++h){f.add(j.elementAt(h).group(0));d+= '</span>';}}d+= '</span>';c[b]=d;}e.setInnerHtml(c.join('\n'),validator:MF);e.classes.add('highlighted');});return true;}else{return false;}}void LF(){AB.Element f=new AB.DivElement()..classes.add('tooltip-inner');AB.Element b=new AB.DivElement()..append(new AB.DivElement()..classes.add('tooltip-arrow'))..append(f)..classes.addAll(['tooltip','left','fade']);b.classes.add(AB.CssStyleDeclaration.supportsTransitions?'out':'in');b.style.display='none';AB.document.body.append(b);b.onTransitionEnd.listen((AB.TransitionEvent d){if(b.classes.contains('out')){b.style.display='none';}});void h(){if(!AB.CssStyleDeclaration.supportsTransitions){b.style.display='none';}else{b.classes..remove('in')..add('out');}}void i(j){b.style..visibility='hidden'..display='block';b.style..left="${j.offsetLeft-b.clientWidth}px"..top="${j.offsetTop-2}px"..visibility="visible";if(AB.CssStyleDeclaration.supportsTransitions){b.classes..remove('out')..add('in');}}AB.Element c;bool e=false;var g=AB.querySelectorAll('span.line');g.onClick.listen((AB.MouseEvent d){if(c==d.currentTarget){if(!e){e=true;return;}h();c=null;e=false;return;}e=true;c=d.currentTarget;f.text='#'+c.getAttribute('data-linenum');i(c);});g.onMouseMove.listen((AB.MouseEvent d){if(e||c==d.currentTarget){return;}c=d.currentTarget;f.text='#'+c.getAttribute('data-linenum');i(c);});g.onMouseOut.listen((AB.MouseEvent d){if(e||c!=d.currentTarget){return;}h();c=null;});}void GF(){var e=AB.querySelectorAll('.note-link');if(e.length==0){return;}AB.Element f=new AB.HeadingElement.h3()..classes.add('popover-title');AB.DivElement g=new AB.DivElement()..classes.add('popover-content');AB.Element b=new AB.DivElement()..append(new AB.DivElement()..classes.add('arrow'))..append(f)..append(g)..classes.addAll(['popover','top','fade']);b.classes.add(AB.CssStyleDeclaration.supportsTransitions?'out':'in');b.style.display='none';AB.document.body.append(b);b.onTransitionEnd.listen((AB.TransitionEvent h){if(b.classes.contains('out')){b.style.display='none';}});var d;final AB.NodeValidatorBuilder MF=new AB.NodeValidatorBuilder.common()..allowNavigation(new sE());e.onClick.listen((AB.MouseEvent h){var c=h.currentTarget;if(d==c){if(!AB.CssStyleDeclaration.supportsTransitions){b.style.display='none';}else{b.classes..remove('in')..add('out');}d=null;return;}f.text="Примечание ${c.text}";var i=AB.querySelector('.footnotes li[data-for=${c.id}]');if(i==null){return;}g.setInnerHtml(i.innerHtml,validator:MF);d=c;b.style..visibility='hidden'..display='block';b.style..left="${c.offsetLeft+(c.clientWidth-b.clientWidth)/2+2}px"..top="${c.offsetTop-b.clientHeight}px"..visibility="visible";if(AB.CssStyleDeclaration.supportsTransitions){b.classes..remove('out')..add('in');}});}void HF(){AB.Element b=AB.querySelector('.pager .previous');AB.Element c=AB.querySelector('.pager .next');bool f=AB.window.navigator.platform.indexOf('Mac')!=-1;if(b!=null){b.attributes['title']+=" (${f?'⌥←':'Ctrl + ←'})";}if(c!=null){c.attributes['title']+=" (${f?'⌥→':'Ctrl + →'})";}if(b!=null||c!=null){AB.document.onKeyDown.listen((AB.KeyboardEvent d){if(d.altKey||d.ctrlKey){AB.Element e;if(d.keyCode==AB.KeyCode.LEFT){e=b;}else if(d.keyCode==AB.KeyCode.RIGHT){e=c;}if(e!=null){AB.window.location.replace(e.querySelector('a').getAttribute('href'));}}});}}void IF(){if(AB.querySelectorAll('span.math').length>0){AB.Element b=new AB.ScriptElement()..type="text/javascript"..async=true..src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML";AB.document.body.append(b);}}}class sE implements AB.UriPolicy{bool allowsUri(String b){return true;}}class mD{AB.Element PF;rB OF;YB.JsObject map;YB.JsObject XB;YB.JsObject CC;mD(this.OF,this.PF){YB.JsObject c=new YB.JsObject.jsify({"behaviors":["drag","scrollZoom","dblClickZoom","multiTouch","rightMouseButtonMagnifier"],"center":[53.906077,27.554914],"zoom":8});map=new YB.JsObject(YB.context['ymaps']['Map'],[this.PF,c]);map['controls'].callMethod('add',['zoomControl']);YB.JsObject b=new YB.JsObject(YB.context['ymaps']['control']['Button'],[new YB.JsObject.jsify({"data":{"content":'<span class="glyphicon glyphicon-fullscreen"></span>',"title":"На полный экран"}}),new YB.JsObject.jsify({"position":{"left":5,"top":5}})]);b['events'].callMethod("add",["select",(cF)=>jF(true)]);b['events'].callMethod("add",["deselect",(cF)=>jF(false)]);map['controls'].callMethod('add',[b]);OF.tC.listen(mC);OF.qC.listen(TE);OF.rC.listen(VE);OF.sC.listen(lC);OF.pC.listen(UE);OF.uC.listen(vC);}void jF(bool b){if(CC==null){CC=map.callMethod("getBounds");}if(b){PF.classes.add("full-screen");}else{PF.classes.remove("full-screen");}map['container'].callMethod("fitToViewport",[] );map.callMethod("setBounds",[CC]);}void mC(nB<m> b){if(b.oC!=null){map["geoObjects"].callMethod("remove",[b.oC.kB]);}YB.JsObject c=b.XC.kB;c['options'].callMethod('set',['preset','twirl#blueDotIcon']);map["geoObjects"].callMethod("add",[c]);}void TE(m c){YB.JsObject b=c.kB;b['options'].callMethod('set',['preset','twirl#blueIcon']);map["geoObjects"].callMethod("add",[b]);}void UE(List<m> c){for(m d in c){YB.JsObject b=d.kB;b['options'].callMethod('set',['preset','twirl#blueIcon']);map["geoObjects"].callMethod("add",[b]);}}void VE(m b){map["geoObjects"].callMethod("remove",[b.kB]);}void lC(List<m> b){for(m c in b){map["geoObjects"].callMethod("remove",[c.kB]);}}void vC(nB<eB> k){if(XB!=null){map["geoObjects"].callMethod("remove",[XB]);}eB d=k.XC;if(d==null){XB=null;return;}var b=d.path[0][0];List<List<double>> i=[] ;double e=b.hB;double g=b.hB;double f=b.qB;double h=b.qB;i.add([b.hB,b.qB]);for(int j=0;j<d.path.length; ++j){m c=d.path[j][1];e=fC.min(e,c.hB);f=fC.min(f,c.qB);g=fC.max(g,c.hB);h=fC.max(h,c.qB);i.add([c.hB,c.qB]);}if(d.vB<sB.FC){YB.JsObject l=new YB.JsObject(YB.context['ymaps']['geometry']['LineString'],[new YB.JsObject.jsify(i),new YB.JsObject.jsify({"coordRendering":'shortestPath',"geodesic":true})]);XB=new YB.JsObject(YB.context['ymaps']['GeoObject'],[new YB.JsObject.jsify({"geometry":l})]);map["geoObjects"].callMethod("add",[XB]);}if(e==g&&f==h){map.callMethod("setCenter",[new YB.JsObject.jsify([e,f]),8]);CC=map.callMethod("getBounds");}else{CC=new YB.JsObject.jsify([[e,f],[g,h]]);map.callMethod("setBounds",[CC]);}}void reset(){if(XB!=null){map["geoObjects"].callMethod("remove",[XB]);}for(m b in OF.VB){map["geoObjects"].callMethod("remove",[b.kB]);}map["geoObjects"].callMethod("remove",[OF.IB.kB]);map["geoObjects"].callMethod("remove",[OF.JB.kB]);}}class lD{rB OF;AB.Element PF;Map<m,AB.LIElement> VF=<m,AB.LIElement>{};lD(this.OF,this.PF){XF();OF..tC.listen(mC)..qC.listen(pB)..pC.listen(QE)..sC.listen(lC)..rC.listen(ZC);}void XF(){AB.LIElement b=new AB.LIElement()..classes.add('list-group-item');new tE(OF,b);AB.UListElement c=new AB.UListElement()..classes.add('list-group')..append(new AB.LIElement()..classes.add('list-group-item')..append(new AB.HeadingElement.h4()..classes.add('list-group-item-heading')..text='Города'))..append(b)..append(new AB.LIElement()..classes.addAll(['list-group-item','first-city']))..append(new AB.LIElement()..classes.addAll(['list-group-item','last-city']));PF.append(c);}void mC(nB<m> b){if(OF.IB!=null){mF(PF.querySelector('.first-city'),false,true,OF.IB);}if(OF.JB!=null){mF(PF.querySelector('.last-city'),true,false,OF.JB);}}void pB(m c){AB.LIElement b=new AB.LIElement()..classes.addAll(['list-group-item']);mF(b,true,true,c);PF.children.first.insertBefore(b,PF.querySelector('.last-city'));VF[c]=b;}void QE(List<m> b)=>b.forEach(pB);void ZC(m b){AB.LIElement c=VF[b];if(c==null){return;}c.remove();VF.remove(b);}void lC(List<m> b)=>b.forEach(ZC);AB.ButtonElement pF(String b,String c){return new AB.ButtonElement()..classes.addAll(["btn","btn-default","btn-xs"])..title=b..append(new AB.SpanElement()..classes.addAll(["glyphicon","glyphicon-${c}"]));}void mF(AB.Element f,bool g,bool h,m b){f.innerHtml='';AB.ButtonElement c=pF("Удалить","remove");if(!g||!h){c.disabled=true;}else{c.onClick.listen((cF)=>OF.ZC(b));}AB.ButtonElement d=pF("В начало","chevron-up");if(!g){d.disabled=true;}else{d.onClick.listen((cF)=>OF.dE(b));}AB.ButtonElement e=pF("В конец","chevron-down");if(!h){e.disabled=true;}else{e.onClick.listen((cF)=>OF.eE(b));}AB.DivElement i=new AB.DivElement()..classes.add("btn-group")..append(c)..append(d)..append(e);f..append(i)..appendText(" "+b.name);}}class oD{rB OF;AB.Element PF;nD TC;oD(this.OF,this.PF){XF();TC=new nD(OF,PF.querySelector('.route-header'));OF.uC.listen(vC);OF.fE.listen(DC);}void XF(){AB.UListElement b=new AB.UListElement()..classes.add('list-group')..append(new AB.LIElement()..classes.addAll(['list-group-item','route-header'])..append(new AB.HeadingElement.h4()..classes.addAll(['list-group-item-heading','route-title'])));PF.append(b);}void DC(bool d){if(d){AB.ElementList b=PF.querySelectorAll('.route-item');b.forEach((c)=>c.remove());AB.Element e=PF.children.first;e.append(new AB.LIElement()..classes.addAll(['list-group-item','route-item','calc-progress'])..append(new AB.DivElement()..classes.addAll(['progress','progress-striped','active'])..append(new AB.DivElement()..classes.add('progress-bar')..style.width='100%')));}else{AB.ElementList b=PF.querySelectorAll('.route-item.calc-progress');b.forEach((c)=>c.remove());}}void vC(nB<eB> d){AB.ElementList e=PF.querySelectorAll('.route-item');e.forEach((f)=>f.remove());eB c=d.XC;if(c==null){PF.querySelector('.route-title').text='Маршрут не существует';return;}PF.querySelector('.route-title').text='Маршрут ${c.YE} км';AB.Element g=PF.children.first;c.path.forEach((List<m> b)=>g.append(new AB.LIElement()..classes.addAll(['list-group-item','route-item'])..append(new AB.SpanElement()..classes.addAll(['badge','distance','pull-right'])..text="${b[0].distanceTo(b[1]).round()} км")..append(new AB.ButtonElement()..classes.addAll(['btn','btn-default','btn-xs'])..title='Исключить'..append(new AB.SpanElement()..classes.addAll(['glyphicon','glyphicon-remove']))..onClick.listen((cF)=>OF.ZE(b)))..appendHtml(' ${b[0].name} &mdash; ${b[1].name}')));}}class pD{AB.Element PF;rB OF;pD(this.OF,this.PF){XF();YF();OF.bD.listen((cF)=>YF());OF.cD.listen((cF)=>YF());}void XF(){AB.UListElement b=new AB.UListElement()..classes.add('list-group')..append(new AB.LIElement()..classes.add('list-group-item')..append(new AB.HeadingElement.h4()..classes.add('list-group-item-heading')..text='Исключения'));PF.append(b);}AB.LIElement iF()=>new AB.LIElement()..classes.addAll(['list-group-item','exclusions-item'])..text='Нет исключений';void YF(){AB.ElementList d=PF.querySelectorAll(".exclusions-item");d.forEach((e)=>e.remove());AB.Element c=PF.children[0];if(OF.wB.length==0){c.append(iF());return;}for(List<m> b in OF.wB){c.append(new AB.LIElement()..classes.addAll(['list-group-item','exclusions-item'])..append(new AB.ButtonElement()..classes.addAll(['btn','btn-default','btn-xs'])..title="Включить"..append(new AB.SpanElement()..classes.addAll(['glyphicon','glyphicon-remove']))..onClick.listen((cF)=>OF.bE(b)))..appendHtml(" ${b[0].name} &mdash; ${b[1].name}"));}}}class qD{static mB.Future<List<m>> rD(String f){mB.Completer<List<m>> c=new mB.Completer<List<m>>();AB.HttpRequest.getString('http://geocode-maps.yandex.ru/1.x/?format=json&geocode='+f).then((String g){jD.JsonDecoder h=new jD.JsonDecoder(null);Map i=h.convert(g);List<m> d=<m>[] ;for(Map b in i['response']['GeoObjectCollection']['featureMember']){if(b['GeoObject']['metaDataProperty']['GeocoderMetaData']['kind']!='locality'){continue;}List<String> e=b['GeoObject']['Point']['pos'].split(' ');d.add(new m(b['GeoObject']['name'],double.parse(e[1]),double.parse(e[0]),b['GeoObject']['metaDataProperty']['GeocoderMetaData']['text']));}c.complete(d);}).catchError(c.completeError);return c.future;}}class m{String NF;String QF;double RF;double UF;m(this.NF,this.RF,this.UF,[this.QF='']);m.AF(String c){List<String> b=c.split("|");NF=b[0];RF=double.parse(b[1]);UF=double.parse(b[2]);QF='';}String get name=>NF;String get aE=>QF;double get hB=>RF;double get qB=>UF;YB.JsObject hF;YB.JsObject get kB{if(hF==null){hF=new YB.JsObject(YB.context['ymaps']['Placemark'],[new YB.JsObject.jsify([RF,UF]),new YB.JsObject.jsify({"balloonContent":NF})]);}return hF;}static const double sD=6371.0;static const double HC=fC.PI/180;double distanceTo(m b){double d=(b.hB-hB)*HC;double e=(b.qB-qB)*HC;double c=fC.pow(fC.sin(d/2.0),2)+fC.cos(hB*HC)*fC.cos(b.hB*HC)*fC.pow(fC.sin(e/2.0),2);double f=2*fC.atan2(fC.sqrt(c),fC.sqrt(1-c));return sD*f;}String toString()=>QF==''?"${NF} (${RF}, ${UF})":"${QF} (${RF}, ${UF})";String gD()=>"${NF}|${RF}|${UF}";}class eB{List<List<m>> path;double vB;int get YE=>vB.round();eB(this.path,this.vB);}class nB<zC>{zC oC;zC XC;nB(this.XC,this.oC);}class tE{rB OF;AB.Element PF;List<m> TF=null;int WF=-1;int get aB=>WF;void set aB(int c){AB.Element b=PF.querySelector('.list-group-item-info');if(b!=null){b.classes.remove('list-group-item-info');}WF=c;b=PF.querySelector('.suggestion-${WF}');if(b!=null){b.classes.add('list-group-item-info');}}List<m> get bB=>TF;void set bB(List<m> e){TF=e;AB.Element c=PF.querySelector('.suggestions-list');if(c!=null){c.remove();}if(TF==null){PF.querySelector('.hide-button').classes.add('hidden');return;}PF.querySelector('.hide-button').classes.remove('hidden');if(TF.length==0){PF.append(new AB.DivElement()..classes.add('suggestions-list')..text='Ничего не найдено.');return;}AB.UListElement d=new AB.UListElement()..classes.addAll(['list-group','suggestions-list']);for(int b=0;b<TF.length; ++b){d.append(new AB.LIElement()..classes.addAll(['list-group-item','suggestion-${b}'])..append(new AB.AnchorElement()..href='#'..text=TF[b].aE..onClick.listen((f){f.preventDefault();pB(TF[b]);})));}PF.append(d);}tE(this.OF,this.PF){XF();}void XF(){AB.FormElement b=new AB.FormElement()..classes.add('form-inline')..append(new AB.DivElement()..classes.add('input-group')..append(new AB.LabelElement()..classes.add('sr-only')..htmlFor="searchText"..text='Добавить город')..append(new AB.SearchInputElement()..classes.addAll(['form-control','input-sm','search-input'])..id='searchText'..autocomplete='off'..placeholder='Добавить город'..onKeyDown.listen(gE))..append(new AB.SpanElement()..classes.add('input-group-btn')..append(new AB.ButtonElement()..classes.addAll(['btn','btn-default','btn-sm','hidden','hide-button'])..title="Скрыть результаты"..append(new AB.SpanElement()..classes.addAll(['glyphicon','glyphicon-remove']))..onClick.listen((cF){bB=null;(PF.querySelector('.search-input') as AB.SearchInputElement).value='';}))..append(new AB.ButtonElement()..classes.addAll(['btn','btn-default','btn-sm'])..title="Искать"..append(new AB.SpanElement()..classes.addAll(['glyphicon','glyphicon-search']))..onClick.listen((cF)=>eD()))));PF.append(b);}void gE(AB.KeyboardEvent c){bool b=false;switch (c.keyCode){case AB.KeyCode.ENTER:if(bB!=null&&aB!=-1){pB(bB[aB]);}else{eD();}b=true;break;case AB.KeyCode.ESC:bB=null;(PF.querySelector('.search-input') as AB.SearchInputElement).value='';b=true;break;case AB.KeyCode.UP:if(bB==null){break;} --aB;if(aB<0){aB=bB.length-1;}rF();b=true;break;case AB.KeyCode.DOWN:if(bB==null){break;} ++aB;if(aB>=bB.length){aB=0;}rF();b=true;break;}if(b){c.preventDefault();c.stopPropagation();}}void pB(m b){OF.pB(b);bB=null;(PF.querySelector('.search-input') as AB.SearchInputElement).value='';}void eD(){qD.rD((PF.querySelector('.search-input') as AB.SearchInputElement).value).then((b){if(b.length==1){pB(b[0]);return;}bB=b;aB=-1;});}void rF(){AB.Element c=AB.querySelector('.suggestions-list .suggestion-${aB}');fC.Point b=c.offsetTo(AB.document.body);if(b.y<AB.window.scrollY+70){AB.window.scrollTo(AB.window.scrollX,b.y-70);}if(b.y+c.clientHeight>AB.window.scrollY+AB.window.innerHeight){AB.window.scrollTo(AB.window.scrollX,b.y+c.clientHeight-AB.window.innerHeight);}}}class nD{AB.Element PF;rB OF;bool SF;bool get BC=>SF;void set BC(bool b){(PF.querySelector('.autoupdate-checkbox') as AB.CheckboxInputElement).checked=b;SF=b;}sB fF;nD(this.OF,this.PF){XF();BC=false;OF.tC.listen(gF);OF.qC.listen(gF);OF.rC.listen(gF);OF.sC.listen(gF);OF.pC.listen(gF);OF.bD.listen(gF);OF.cD.listen(gF);}void XF(){PF.insertBefore(new AB.ButtonElement()..classes.addAll(['btn','btn-default','btn-xs','pull-right','refresh-button'])..title='Обновить'..append(new AB.SpanElement()..classes.addAll(["glyphicon","glyphicon-refresh"])..onClick.listen((cF)=>TD())),PF.children[0]);PF.append(new AB.FormElement()..append(new AB.DivElement()..classes.add("checkbox")..append(new AB.LabelElement()..append(new AB.CheckboxInputElement()..classes.add('autoupdate-checkbox')..onChange.listen((b)=>SF=(PF.querySelector('.autoupdate-checkbox') as AB.CheckboxInputElement).checked))..appendText("Автообновление"))));}mB.Timer oF;static final Duration tD=new Duration(milliseconds:50);void gF(cF){if(!BC){return;}if(oF!=null&&oF.isActive){oF.cancel();}oF=new mB.Timer(tD,TD);}void TD(){if(fF!=null){fF.cancel();OF.DC=false;fF=null;}mB.Timer.run(qF);}void qF(){if(fF!=null){return;}if(OF.VB.length==0){bool k=false;OF.wB.forEach((List<m> f){if(f[0]==OF.IB&&f[1]==OF.JB||f[1]==OF.IB&&f[0]==OF.JB){k=true;}});if(k){OF.path=null;return;}OF.path=new eB(<List<m>>[<m>[OF.IB,OF.JB]],OF.IB.distanceTo(OF.JB));return;}OF.DC=true;List<m> d=<m>[OF.IB];d.addAll(OF.VB);d.add(OF.JB);int g=d.length;List<List<double>> c=<List<double>>[] ;for(int b=0;b<g; ++b){c.add(new List<double>.filled(g,sB.FC));}for(int b=0;b<OF.VB.length; ++b){c[0][b+1]=OF.IB.distanceTo(OF.VB[b]);c[b+1][g-1]=OF.JB.distanceTo(OF.VB[b]);}c[g-1][0]=0.0;for(int b=0;b<OF.VB.length-1; ++b){for(int e=b+1;e<OF.VB.length; ++e){double l=OF.VB[b].distanceTo(OF.VB[e]);c[b+1][e+1]=l;c[e+1][b+1]=l;}}if(OF.wB!=null){for(List<m> n in OF.wB){int h=-1;while((h=d.indexOf(n[0],h+1))!=-1){int i=-1;while((i=d.indexOf(n[1],i+1))!=-1){c[h][i]=sB.FC;c[i][h]=sB.FC;}}}}AB.Element j=AB.querySelector('.route-widget .refresh-button');AB.Element o=j.querySelector('.glyphicon');j.classes.add('disabled');o.classes.add('in-progress');fF=new vE();fF.fD(c).then((q){sF(q);}).whenComplete((){o.classes.remove('in-progress');j.classes.remove('disabled');fF=null;OF.DC=false;}).catchError((cF){});}m tF(int b){if(b==0){return OF.IB;}else if(b==OF.VB.length+1){return OF.JB;}else{return OF.VB[b-1];}}void sF(IC b){if(b.vB>sB.FC){OF.path=null;}else{List<List<m>> d=<List<m>>[] ;for(int c=0;c<b.YC.length-1; ++c){d.add(<m>[tF(b.YC[c]),tF(b.YC[c+1])]);}OF.path=new eB(d,b.vB);}}}class rB{List<m> VF;m ZF;m aF;eB bF;List<List<m>> dF;bool eF;rB(){VF=<m>[] ;dF=<List<m>>[] ;}m get IB=>ZF;void set IB(m b){m c=ZF;ZF=b;GC.add(new nB(b,c));}m get JB=>aF;void set JB(m b){m c=aF;aF=b;GC.add(new nB(b,c));}eB get path=>bF;void set path(eB b){eB c=bF;bF=b;dD.add(new nB(b,c));}List<m> get VB=>VF;void pB(m b){VF.add(b);VC.add(b);}void PE(List<m> b){VF.addAll(b);SD.add(b);}void ZC(m b){VF.remove(b);WC.add(b);}void hE(){List<m> b=VF;VF=<m>[] ;VD.add(b);}void dE(m c){m b=ZF;VF.remove(c);WC.add(c);IB=c;if(VF.indexOf(b)==-1&&JB!=b){VF.add(b);VC.add(b);}else if(JB==b){GC.add(new nB(JB,JB));}}void eE(m c){m b=aF;VF.remove(c);WC.add(c);JB=c;if(VF.indexOf(b)==-1&&b!=IB){VF.add(b);VC.add(b);}else if(b==IB){GC.add(new nB(IB,IB));}}List<List<m>> get wB=>dF;void ZE(List<m> b){if(dF.contains(b)){return;}dF.add(b);WD.add(b);}void bE(List<m> b){if(dF.remove(b)){YD.add(b);}}bool get DC=>eF;void set DC(bool b){eF=b;UD.add(b);}mB.StreamController<nB<m>> GC=new mB.StreamController<nB<m>>.broadcast(sync:true);mB.Stream<nB<m>> get tC=>GC.stream;mB.StreamController<m> VC=new mB.StreamController<m>.broadcast(sync:true);mB.Stream<m> get qC=>VC.stream;mB.StreamController<m> WC=new mB.StreamController<m>.broadcast(sync:true);mB.Stream<m> get rC=>WC.stream;mB.StreamController<List<m>> VD=new mB.StreamController<List<m>>.broadcast(sync:true);mB.Stream<List<m>> get sC=>VD.stream;mB.StreamController<List<m>> SD=new mB.StreamController<List<m>>.broadcast(sync:true);mB.Stream<List<m>> get pC=>SD.stream;mB.StreamController<nB<eB>> dD=new mB.StreamController<nB<eB>>.broadcast(sync:true);mB.Stream<nB<eB>> get uC=>dD.stream;mB.StreamController<List<m>> WD=new mB.StreamController<List<m>>.broadcast(sync:true);mB.Stream<List<m>> get bD=>WD.stream;mB.StreamController<List<m>> YD=new mB.StreamController<List<m>>.broadcast(sync:true);mB.Stream<List<m>> get cD=>YD.stream;mB.StreamController<bool> UD=new mB.StreamController<bool>.broadcast(sync:true);mB.Stream<bool> get fE=>UD.stream;}class uE{rB OF;mD map;lD SE;pD wB;oD XB;uE(){OF=new rB();map=new mD(OF,AB.querySelector('.map-widget'));SE=new lD(OF,AB.querySelector('.cities-list-widget'));XB=new oD(OF,AB.querySelector('.route-widget'));wB=new pD(OF,AB.querySelector('.exclusions-widget'));kF();AB.window.onHashChange.listen(lF);OF.uC.listen((cF)=>iE());XB.TC.BC=true;AB.querySelector('.main-widget').classes.remove('hidden');}void kF(){bool c=nF();if(!c){m b=new m("Минск",53.906077,27.554914);OF.IB=b;OF.JB=b;OF.path=new eB(<List<m>>[[b,b]],0.0);}}void lF(AB.Event b){XB.TC.BC=false;map.reset();kF();XB.TC.BC=true;}bool nF(){String d=AB.window.location.hash;if(d==''||d=='#'){return false;}d=d.substring(1);try {List<int> l=RD.OE(d);List<int> n=new xE().XE(l);String o=jD.UTF8.decode(n);List b=jD.JSON.decode(o);bool j=false;int g;if(b.last is bool&&b.last==true){j=true;b.removeLast();g=b.length;}else{g=b.length-1;}OF.hE();OF.IB=new m.AF(b.first);List<m> k=[] ;double h=0.0;List<List<m>> e=<List<m>>[] ;m c=OF.IB;for(int i=1;i<g; ++i){m f=new m.AF(b[i]);k.add(f);e.add(<m>[c,f]);h+= c.distanceTo(f);c=f;}if(j){OF.JB=OF.IB;e.add(<m>[c,OF.IB]);}else{OF.JB=new m.AF(b.last);e.add(<m>[c,OF.JB]);}h+= c.distanceTo(OF.JB);OF.PE(k);OF.path=new eB(e,h);}catch (q){return false;}return true;}void iE(){if(OF.path==null){AB.window.location.hash='#';}List b=[OF.IB.gD()];int e=OF.path.path.length-(OF.IB==OF.JB?1:0);for(int c=0;c<e; ++c){b.add(OF.path.path[c][1].gD());}if(OF.IB==OF.JB){b.add(true);}List<int> f=jD.UTF8.encode(jD.JSON.encode(b));List<int> g=new yE().encode(f);String d=RD.NE(g);if(AB.History.supportsState){AB.window.history.replaceState(null,AB.document.title,AB.window.location.pathname+"#"+d);}else{AB.window.location.hash='#'+d;}}}abstract class sB{static final double FC=1e8;bool UC=false;mB.Future<IC> fD(List<List<double>> b);void cancel(){UC=true;}}class vE extends sB{int uF;List<List<double>> vF;List<List<int>> wF;List<List<double>> xF;List<List<double>> yF;List<fB> zF;List<int> AG;double BG;fC.Random CG=new fC.Random();int DG;int EG;static final double uD=0.1;static final double vD=2.0;static final double wD=0.5;static final double xD=1-wD;static final int AD=50;static final int yD=100;static final double tB=0.01;mB.Future<IC> fD(List<List<double>> e){mB.Completer<IC> b=new mB.Completer<IC>();UC=false;vF=e;DG=e.length*100;FG();int h=0;int c=0;void f(){if(UC){b.completeError("Cancelled");return;}if(c<yD){ ++c; ++h;GG();HG();IG();bool g=false;for(fB d in zF){if(AG==null||d.iB<BG){AG=d.TB;BG=d.iB;g=true;}}if(g){c=0;}mB.Timer.run(f);}else{mB.Timer.run((){if(UC){b.completeError("Cancelled");return;}JG();b.complete(new IC(AG,BG));});}}mB.Timer.run(f);return b.future;}void FG(){uF=vF.length;EG=(AD/2).round();xF=<List<double>>[] ;yF=<List<double>>[] ;for(int b=0;b<uF; ++b){xF.add(new List<double>.filled(uF,1.0));yF.add(new List<double>.filled(uF,0.0));}KG=new List<double>.filled(uF,0.0);LG();MG();NG();}void LG(){wF=<List<int>>[] ;for(int c=0;c<uF; ++c){List<BD<int,double>> d=<BD<int,double>>[] ;for(int b=0;b<uF; ++b){d.add(new BD(b,vF[c][b]));}d.sort((f,g)=>Comparable.compare(f.nC,g.nC));List<int> e=<int>[] ;for(int b=0;b<uF; ++b){e.add(d[b].aD);}wF.add(e);}}void MG(){for(int b=0;b<uF; ++b){for(int c=0;c<uF; ++c){yF[b][c]=fC.pow(xF[b][c],uD)*fC.pow(vF[b][c],-vD);}}}void NG(){zF=<fB>[] ;for(int b=0;b<AD; ++b){zF.add(new fB());}}void GG(){for(fB b in zF){b.reset(uF);}for(int c=1;c<uF-1; ++c){for(fB b in zF){OG(b,c);}}for(fB b in zF){int d=b.TB.last;b.TB.add(uF-1);b.iB+= vF[d][uF-1];}}List<double> KG;void OG(fB c,int g){int d=c.TB[g-1];double e=0.0;for(int b=1;b<uF-1; ++b){if(c.aC[b]){KG[b]=0.0;}else{KG[b]=yF[d][b];e+= KG[b];}}double h=CG.nextDouble()*e;int b=1;double f=KG[b];while(f<h){ ++b;f+= KG[b];}c.TB.add(b);c.iB+= vF[d][b];c.aC[b]=true;}void HG(){for(fB b in zF){bool f=true;if(f){f=false;int c=1;for(;!f&&c<uF-2; ++c){int g=b.TB[c-1];int h=b.TB[c];double l=-vF[g][h];for(int d=c+1;!f&&d<uF-1; ++d){int i=b.TB[d];int j=b.TB[d+1];double k=l-vF[i][j]+vF[g][i]+vF[h][j];if(k<0){int n=((d-c+1)/2).floor();for(int e=0;e<n; ++e){int o=b.TB[c+e];b.TB[c+e]=b.TB[d-e];b.TB[d-e]=o;}b.iB+= k; --c;f=true;}}}}}}void IG(){PG();zF.sort((fB c,fB d)=>-Comparable.compare(c.iB,d.iB));for(int b=0;b<EG-1; ++b){QG(zF[b].iB,zF[b].TB,(EG-b-1).toDouble());}if(BG!=null){QG(BG,AG,EG.toDouble());}MG();}void PG(){for(int b=0;b<uF-1; ++b){for(int c=b;c<uF; ++c){xF[b][c]*=xD;xF[c][b]=xF[b][c];}}}void QG(double f,List<int> c,double g){double h=g/f;for(int b=0;b<c.length-1; ++b){int d=c[b];int e=c[b+1];xF[d][e]+=h;xF[e][d]=xF[d][e];}}void JG(){List<double> r=new List<double>.filled(uF,0.0);List<double> s=new List<double>.filled(uF,0.0);List<int> e=new List<int>.from(AG);double g;bool v=true;void w(){for(int b=1;b<uF; ++b){r[b]=r[b-1]+vF[e[b-1]][e[b]];}g=r.last;for(int b=uF-2;b>=0; --b){s[b]=s[b+1]+vF[e[b+1]][e[b]];}}double t(h,f){if(h<=f){return r[f]-r[h];}else{return s[f]-s[h];}}double j(h,f,o,k,q,u)=>t(0,h)+vF[e[h]][e[f]]+t(f,o)+vF[e[o]][e[k]]+t(k,q)+vF[e[q]][e[u]]+t(u,uF-1);void l(h,f,o,k,q,u){v=true;List<int> i=new List<int>.from(e);int n=h+1;i[n++ ]=e[f];if(f<o){for(int b=f+1;b<=o; ++b){i[n++ ]=e[b];}}else{for(int b=f-1;b>=o; --b){i[n++ ]=e[b];}}i[n++ ]=e[k];if(k<q){for(int b=k+1;b<=q; ++b){i[n++ ]=e[b];}}else{for(int b=k-1;b>=q; --b){i[n++ ]=e[b];}}i[n++ ]=e[u];e=i;w();}w();while(v){v=false;for(int b=0;b<uF-3; ++b){for(int c=b+1;c<uF-2; ++c){for(int d=c+1;d<uF-1; ++d){if(j(b,b+1,c,d,c+1,d+1)-g<-tB){l(b,b+1,c,d,c+1,d+1);}if(j(b,c,b+1,c+1,d,d+1)-g<-tB){l(b,c,b+1,c+1,d,d+1);}if(j(b,c,b+1,d,c+1,d+1)-g<-tB){l(b,c,b+1,d,c+1,d+1);}if(j(b,c+1,d,b+1,c,d+1)-g<-tB){l(b,c+1,d,b+1,c,d+1);}if(j(b,c+1,d,c,b+1,d+1)-g<-tB){l(b,c+1,d,c,b+1,d+1);}if(j(b,d,c+1,b+1,c,d+1)-g<-tB){l(b,d,c+1,b+1,c,d+1);}if(j(b,d,c+1,c,b+1,d+1)-g<-tB){l(b,d,c+1,c,b+1,d+1);}}}}};AG=e;BG=g;}}class IC{List<int> YC;double vB;IC(this.YC,this.vB);}class BD<zD,AE>{final zD aD;final AE nC;const BD(this.aD,this.nC);}class fB{double iB;List<int> TB;List<bool> aC;fB(){iB=0.0;}void reset(int b){iB=0.0;aC=new List<bool>.filled(b,false);aC[0]=true;TB=<int>[0];}}void main(){kD b=new kD();b.cE();YB.context['ymaps'].callMethod('ready',[()=>new uE()]);}class BE{KC WB;BE(this.WB);void FB(int b)=>NB(8,b);void bC(List<int> c){for(int b=0;b<c.length; ++b){NB(8,c[b]);}}void wC(int b){NB(32,b);}void NB(int c,int b){if(SG==8&&c==8){WB.FB(b&0xff);return;}if(SG==8&&c==16){WB.FB((b>>8)&0xff);WB.FB(b&0xff);return;}if(SG==8&&c==24){WB.FB((b>>16)&0xff);WB.FB((b>>8)&0xff);WB.FB(b&0xff);return;}if(SG==8&&c==32){WB.FB((b>>24)&0xff);WB.FB((b>>16)&0xff);WB.FB((b>>8)&0xff);WB.FB(b&0xff);return;}while(c>0){c-- ;int d=(b>>c)&0x1;TG=(TG<<1)|d;SG-- ;if(SG==0){WB.FB(TG);SG=8;TG=0;}}}void flush(){if(SG!=8){NB(SG,0);}}int TG=0;int SG=8;}class JC{gC input;JC(this.input);int QB()=>SB(8);int SB(int b){if(b==0){return 0;}if(SG==0){SG=8;TG=input.QB();}int c=0;while(b>SG){c=(c<<SG)+(TG&ID[SG]);b-= SG;SG=8;TG=input.QB();}if(b>0){if(SG==0){SG=8;TG=input.QB();}c=(c<<b)+(TG>>(SG-b)&ID[b]);SG-= b;}return c;}int TG=0;int SG=0;static const List<int> ID=const[0,1,3,7,15,31,63,127,255];}class MB{static int CD=0xffffffff;static int uB(int c,int b){return ((b<<8)^CE[(b>>24)&0xff^(c&0xff)])&0xffffffff;}static int ED(int b){return b^0xffffffff;}static const List<int> MC=const[0x42,0x5a,0x68];static const int FD=0x30;static const List<int> GD=const[0x31,0x41,0x59,0x26,0x53,0x59];static const List<int> HD=const[0x17,0x72,0x45,0x38,0x50,0x90];static const List<int> CE=const[0x00000000,0x04c11db7,0x09823b6e,0x0d4326d9,0x130476dc,0x17c56b6b,0x1a864db2,0x1e475005,0x2608edb8,0x22c9f00f,0x2f8ad6d6,0x2b4bcb61,0x350c9b64,0x31cd86d3,0x3c8ea00a,0x384fbdbd,0x4c11db70,0x48d0c6c7,0x4593e01e,0x4152fda9,0x5f15adac,0x5bd4b01b,0x569796c2,0x52568b75,0x6a1936c8,0x6ed82b7f,0x639b0da6,0x675a1011,0x791d4014,0x7ddc5da3,0x709f7b7a,0x745e66cd,0x9823b6e0,0x9ce2ab57,0x91a18d8e,0x95609039,0x8b27c03c,0x8fe6dd8b,0x82a5fb52,0x8664e6e5,0xbe2b5b58,0xbaea46ef,0xb7a96036,0xb3687d81,0xad2f2d84,0xa9ee3033,0xa4ad16ea,0xa06c0b5d,0xd4326d90,0xd0f37027,0xddb056fe,0xd9714b49,0xc7361b4c,0xc3f706fb,0xceb42022,0xca753d95,0xf23a8028,0xf6fb9d9f,0xfbb8bb46,0xff79a6f1,0xe13ef6f4,0xe5ffeb43,0xe8bccd9a,0xec7dd02d,0x34867077,0x30476dc0,0x3d044b19,0x39c556ae,0x278206ab,0x23431b1c,0x2e003dc5,0x2ac12072,0x128e9dcf,0x164f8078,0x1b0ca6a1,0x1fcdbb16,0x018aeb13,0x054bf6a4,0x0808d07d,0x0cc9cdca,0x7897ab07,0x7c56b6b0,0x71159069,0x75d48dde,0x6b93dddb,0x6f52c06c,0x6211e6b5,0x66d0fb02,0x5e9f46bf,0x5a5e5b08,0x571d7dd1,0x53dc6066,0x4d9b3063,0x495a2dd4,0x44190b0d,0x40d816ba,0xaca5c697,0xa864db20,0xa527fdf9,0xa1e6e04e,0xbfa1b04b,0xbb60adfc,0xb6238b25,0xb2e29692,0x8aad2b2f,0x8e6c3698,0x832f1041,0x87ee0df6,0x99a95df3,0x9d684044,0x902b669d,0x94ea7b2a,0xe0b41de7,0xe4750050,0xe9362689,0xedf73b3e,0xf3b06b3b,0xf771768c,0xfa325055,0xfef34de2,0xc6bcf05f,0xc27dede8,0xcf3ecb31,0xcbffd686,0xd5b88683,0xd1799b34,0xdc3abded,0xd8fba05a,0x690ce0ee,0x6dcdfd59,0x608edb80,0x644fc637,0x7a089632,0x7ec98b85,0x738aad5c,0x774bb0eb,0x4f040d56,0x4bc510e1,0x46863638,0x42472b8f,0x5c007b8a,0x58c1663d,0x558240e4,0x51435d53,0x251d3b9e,0x21dc2629,0x2c9f00f0,0x285e1d47,0x36194d42,0x32d850f5,0x3f9b762c,0x3b5a6b9b,0x0315d626,0x07d4cb91,0x0a97ed48,0x0e56f0ff,0x1011a0fa,0x14d0bd4d,0x19939b94,0x1d528623,0xf12f560e,0xf5ee4bb9,0xf8ad6d60,0xfc6c70d7,0xe22b20d2,0xe6ea3d65,0xeba91bbc,0xef68060b,0xd727bbb6,0xd3e6a601,0xdea580d8,0xda649d6f,0xc423cd6a,0xc0e2d0dd,0xcda1f604,0xc960ebb3,0xbd3e8d7e,0xb9ff90c9,0xb4bcb610,0xb07daba7,0xae3afba2,0xaafbe615,0xa7b8c0cc,0xa379dd7b,0x9b3660c6,0x9ff77d71,0x92b45ba8,0x9675461f,0x8832161a,0x8cf30bad,0x81b02d74,0x857130c3,0x5d8a9099,0x594b8d2e,0x5408abf7,0x50c9b640,0x4e8ee645,0x4a4ffbf2,0x470cdd2b,0x43cdc09c,0x7b827d21,0x7f436096,0x7200464f,0x76c15bf8,0x68860bfd,0x6c47164a,0x61043093,0x65c52d24,0x119b4be9,0x155a565e,0x18197087,0x1cd86d30,0x029f3d35,0x065e2082,0x0b1d065b,0x0fdc1bec,0x3793a651,0x3352bbe6,0x3e119d3f,0x3ad08088,0x2497d08d,0x2056cd3a,0x2d15ebe3,0x29d4f654,0xc5a92679,0xc1683bce,0xcc2b1d17,0xc8ea00a0,0xd6ad50a5,0xd26c4d12,0xdf2f6bcb,0xdbee767c,0xe3a1cbc1,0xe760d676,0xea23f0af,0xeee2ed18,0xf0a5bd1d,0xf464a0aa,0xf9278673,0xfde69bc4,0x89b8fd09,0x8d79e0be,0x803ac667,0x84fbdbd0,0x9abc8bd5,0x9e7d9662,0x933eb0bb,0x97ffad0c,0xafb010b1,0xab710d06,0xa6322bdf,0xa2f33668,0xbcb4666d,0xb8757bda,0xb5365d03,0xb1f740b4];}class KC{int length;final int byteOrder;KC({int size: NC,this.byteOrder: DD}):RG=new z.Uint8List(size==null?NC:size),length=0;List<int> XD(){return new z.Uint8List.view(RG.buffer,0,length);}void clear(){RG=new z.Uint8List(NC);length=0;}void FB(int b){if(length==RG.length){fG();}RG[length++ ]=b&0xff;}void bC(List<int> c,[int b]){if(b==null){b=c.length;}while(length+b>RG.length){fG((length+b)-RG.length);}RG.setRange(length,length+b,c);length+= b;}void wC(int b){if(byteOrder==LC){FB((b>>24)&0xff);FB((b>>16)&0xff);FB((b>>8)&0xff);FB((b)&0xff);return;}FB((b)&0xff);FB((b>>8)&0xff);FB((b>>16)&0xff);FB((b>>24)&0xff);}void fG([int b]){int c=NC;if(b!=null){if(b>c){c=b;}}z.Uint8List d=new z.Uint8List(RG.length+c);d.setRange(0,RG.length,RG);RG=d;}static const int NC=0x8000;z.Uint8List RG;}const int DD=0;const int LC=1;class gC{final List<int> buffer;int offset;final int start;final int byteOrder;gC(b,{this.byteOrder: DD,int start: 0,int length}):this.buffer=b is z.ByteData?new z.Uint8List.view(b.buffer):b,this.start=start{WG=length==null?buffer.length:length;offset=start;}int get length=>WG-(offset-start);bool get ZD=>offset>=(start+WG);void reset(){offset=start;}int operator[](int b)=>buffer[offset+b];int indexOf(int c,[int d=0]){for(int b=this.offset+d,e=this.offset+length;b<e; ++b){if(buffer[b]==c){return b-this.start;}}return -1;}void skip(int b){offset+= b;}int QB(){return buffer[offset++ ];}int WG;}class wE implements Exception{final String message;wE(this.message);String toString()=>"ArchiveException: ${message}";}class xE{List<int> XE(List<int> b,{bool verify: true}){return WE(new gC(b,byteOrder:LC),verify:verify);}List<int> WE(gC UG,{bool verify: false}){KC g=new KC();JC b=new JC(UG);XG=0;YG=0;aG=0;bG=0;if(b.QB()!=MB.MC[0]||b.QB()!=MB.MC[1]||b.QB()!=MB.MC[2]){throw new wE('Invalid Signature');}iG=b.QB()-MB.FD;if(iG<0||iG>9){throw new wE('Invalid BlockSize');}oG=new z.Uint32List(iG*100000);int e=0;while(true){int h=rG(b);if(h==KD){int d=0;d=(d<<8)|b.QB();d=(d<<8)|b.QB();d=(d<<8)|b.QB();d=(d<<8)|b.QB();int f=uG(b,g);f=MB.ED(f);if(verify&&f!=d){throw new wE('Invalid block checksum.');}e=((e<<1)|(e>>31))&0xffffffff;e^= f;}else if(h==LD){int c=0;c=(c<<8)|b.QB();c=(c<<8)|b.QB();c=(c<<8)|b.QB();c=(c<<8)|b.QB();if(verify&&c!=e){throw new wE('Invalid combined checksum: ${e} : ${c}');}return g.XD();}}return null;}int rG(JC f){bool d=true;bool c=true;for(int b=0;b<6; ++b){int e=f.QB();if(e!=MB.GD[b]){c=false;}if(e!=MB.HD[b]){d=false;}if(!d&&!c){throw new wE('Invalid Block Signature');}}return (c)?KD:LD;}int uG(JC i,KC jB){int cC=i.SB(1);int GB=i.SB(8);GB=(GB<<8)|i.SB(8);GB=(GB<<8)|i.SB(8);HH=new z.Uint8List(16);for(int b=0;b<16; ++b){HH[b]=i.SB(1);}wG=new z.Uint8List(256);for(int b=0,dC=0;b<16; ++b,dC+= 16){if(HH[b]!=0){for(int EB=0;EB<16; ++EB){wG[dC+EB]=i.SB(1);}}}JH();if(KH==0){throw new wE('Data error');}int xB=KH+2;int OB=i.SB(3);if(OB<2||OB>6){throw new wE('Data error');}MH=i.SB(15);if(MH<1){throw new wE('Data error');}nG=new z.Uint8List(JD);mG=new z.Uint8List(JD);for(int b=0;b<MH; ++b){int EB=0;while(true){int RB=i.SB(1);if(RB==0){break;}EB++ ;if(EB>=OB){throw new wE('Data error');}}nG[b]=EB;}z.Uint8List UB=new z.Uint8List(oB);for(int b=0;b<OB; ++b){UB[b]=b;}for(int b=0;b<MH; ++b){int cB=nG[b];int eC=UB[cB];while(cB>0){UB[cB]=UB[cB-1];cB-- ;}UB[0]=eC;mG[b]=eC;}pG=new List<z.Uint8List>(oB);for(int h=0;h<OB; ++h){pG[h]=new z.Uint8List(ZB);int PB=i.SB(5);for(int b=0;b<xB; ++b){while(true){if(PB<1||PB>20){throw new wE('Data error');}int RB=i.SB(1);if(RB==0){break;}RB=i.SB(1);if(RB==0){PB++ ;}else{PB-- ;}}pG[h][b]=PB;}}PH=new List<z.Int32List>(oB);QH=new List<z.Int32List>(oB);RH=new List<z.Int32List>(oB);SH=new z.Int32List(oB);for(int h=0;h<OB;h++ ){PH[h]=new z.Int32List(ZB);QH[h]=new z.Int32List(ZB);RH[h]=new z.Int32List(ZB);int lB=32;int yB=0;for(int b=0;b<xB; ++b){if(pG[h][b]>yB){yB=pG[h][b];}if(pG[h][b]<lB){lB=pG[h][b];}}TH(PH[h],QH[h],RH[h],pG[h],lB,yB,xB);SH[h]=lB;}int xC=KH+1;int EC=100000*iG;int hD=-1;int iD=0;UH=new z.Int32List(256);VH=new z.Uint8List(iC);WH=new z.Int32List(256~/gB);int KB=iC-1;for(int v=256~/gB-1;v>=0;v-- ){for(int LB=gB-1;LB>=0;LB-- ){VH[KB]=v*gB+LB;KB-- ;}WH[v]=KB+1;}int r=0;XG=0;YG=-1;int t=XH(i);int o=0;while(true){if(t==xC){break;}if(t==PC||t==QC){int BB=-1;int dB=1;do{if(dB>=2*1024*1024){throw new wE('Data error');}if(t==PC){BB=BB+(0+1)*dB;}else if(t==QC){BB=BB+(1+1)*dB;}dB=dB*2;t=XH(i);}while(t==PC||t==QC);BB++ ;o=YH[VH[WH[0]]];UH[o]+=BB;while(BB>0){if(r>=EC){throw new wE('Data error');}oG[r]=o;r++ ;BB-- ;};continue;}else{if(r>=EC){throw new wE('Data error');}int q=t-1;if(q<gB){int s=WH[0];o=VH[s+q];while(q>3){int CB=s+q;VH[(CB)]=VH[(CB)-1];VH[(CB)-1]=VH[(CB)-2];VH[(CB)-2]=VH[(CB)-3];VH[(CB)-3]=VH[(CB)-4];q-= 4;}while(q>0){VH[(s+q)]=VH[(s+q)-1];q-- ;}VH[s]=o;}else{int DB=q~/gB;int yC=q%gB;int s=WH[DB]+yC;o=VH[s];while(s>WH[DB]){VH[s]=VH[s-1];s-- ;}WH[DB]++;while(DB>0){WH[DB]--;VH[WH[DB]]=VH[WH[DB-1]+gB-1];DB-- ;}WH[0]--;VH[WH[0]]=o;if(WH[0]==0){KB=iC-1;for(int v=256~/gB-1;v>=0;v-- ){for(int LB=gB-1;LB>=0;LB-- ){VH[KB]=VH[WH[v]+LB];KB-- ;}WH[v]=KB+1;}}}UH[YH[o]]++;oG[r]=(YH[o]);r++ ;t=XH(i);continue;}}if(GB<0||GB>=r){throw new wE('Data error');}for(int b=0;b<=255;b++ ){if(UH[b]<0||UH[b]>r){throw new wE('Data error');}}ZH=new z.Int32List(257);ZH[0]=0;for(int b=1;b<=256;b++ ){ZH[b]=UH[b-1];}for(int b=1;b<=256;b++ ){ZH[b]+=ZH[b-1];}for(int b=0;b<=256;b++ ){if(ZH[b]<0||ZH[b]>r){throw new wE('Data error');}}for(int b=1;b<=256;b++ ){if(ZH[b-1]>ZH[b]){throw new wE('Data error');}}for(int b=0;b<r;b++ ){o=(oG[b]&0xff);oG[ZH[o]]|=(b<<8);ZH[o]++;}int k=MB.CD;int c=oG[GB]>>8;int zB=0;int l;int f=0;int e=0;if(cC!=0){f=0;e=0;if(c>=100000*iG){throw new wE('Data error');}c=oG[c];l=c&0xff;c>>= 8;zB++ ;if(f==0){f=AC[e];e++ ;if(e==512){e=0;}}f-- ;l^= ((f==1)?1:0);}else{if(c>=100000*iG){return k;}c=oG[c];l=(c&0xff);c>>= 8;zB++ ;}int j=0;int n=0;int u=r+1;int g=zB;int w=l;int d;if(cC!=0){while(true){while(true){if(j==0){break;}jB.FB(n);k=MB.uB(n,k);j-- ;}if(g==u){return k;}if(g>u){throw new wE('Data error.');}j=1;n=l;c=oG[c];d=c&0xff;c>>= 8;if(f==0){f=AC[e];e++ ;if(e==512){e=0;}}f-- ;d^= ((f==1)?1:0);g++ ;if(g==u){continue;}if(d!=l){l=d;continue;}j=2;c=oG[c];d=c&0xff;c>>= 8;if(f==0){f=AC[e];e++ ;if(e==512){e=0;}}d^= ((f==1)?1:0);g++ ;if(g==u){continue;}if(d!=l){l=d;continue;}j=3;c=oG[c];d=c&0xff;c>>= 8;if(f==0){f=AC[e];e++ ;if(e==512){e=0;}}d^= ((f==1)?1:0);g++ ;if(g==u){continue;}if(d!=l){l=d;continue;}c=oG[c];d=c&0xff;c>>= 8;if(f==0){f=AC[e];e++ ;if(e==512){e=0;}}d^= ((f==1)?1:0);g++ ;j=d+4;c=oG[c];l=c&0xff;c>>= 8;if(f==0){f=AC[e];e++ ;if(e==512){e=0;}}l^= ((f==1)?1:0);g++ ;}}else{while(true){if(j>0){while(true){if(j==1){break;}jB.FB(n);k=MB.uB(n,k);j-- ;}jB.FB(n);k=MB.uB(n,k);}if(g>u){throw new wE('Data error');}if(g==u){j=0;return k;}n=w;int d;if(c>=100000*iG){throw new wE('Data Error');}c=oG[c];d=c&0xff;c>>= 8;g++ ;if(d!=w){w=d;jB.FB(n);k=MB.uB(n,k);j=0;continue;}if(g==u){jB.FB(n);k=MB.uB(n,k);j=0;continue;}j=2;if(c>=100000*iG){throw new wE('Data Error');}c=oG[c];d=c&0xff;c>>= 8;g++ ;if(g==u){continue;}if(d!=w){w=d;continue;}j=3;if(c>=100000*iG){throw new wE('Data Error');}c=oG[c];d=c&0xff;c>>= 8;g++ ;if(g==u){continue;}if(d!=w){w=d;continue;}if(c>=100000*iG){throw new wE('Data Error');}c=oG[c];d=c&0xff;c>>= 8;g++ ;j=d+4;if(c>=100000*iG){throw new wE('Data Error');}c=oG[c];w=c&0xff;c>>= 8;g++ ;}}return k;}int XH(JC d){if(XG==0){YG++ ;if(YG>=MH){throw new wE('Data error');}XG=RC;aG=mG[YG];bG=SH[aG];cH=PH[aG];dH=RH[aG];eH=QH[aG];}XG-- ;int b=bG;int c=d.SB(b);while(true){if(b>20){throw new wE('Data error');}if(c<=cH[b]){break;}b++ ;int e=d.SB(1);c=(c<<1)|e;}if(c-eH[b]<0||c-eH[b]>=ZB){throw new wE('Data error');}return dH[c-eH[b]];}void TH(z.Int32List e,z.Int32List c,z.Int32List l,z.Uint8List i,int f,int g,int j){int k=0;for(int b=f;b<=g;b++ ){for(int d=0;d<j;d++ ){if(i[d]==b){l[k]=d;k++ ;}}}for(int b=0;b<hC;b++ ){c[b]=0;}for(int b=0;b<j;b++ ){c[i[b]+1]++;}for(int b=1;b<hC;b++ ){c[b]+=c[b-1];}for(int b=0;b<hC;b++ ){e[b]=0;}int h=0;for(int b=f;b<=g;b++ ){h+= (c[b+1]-c[b]);e[b]=h-1;h<<= 1;}for(int b=f+1;b<=g;b++ ){c[b]=((e[b-1]+1)<<1)-c[b];}}void JH(){KH=0;YH=new z.Uint8List(256);for(int b=0;b<256; ++b){if(wG[b]!=0){YH[KH++ ]=b;}}}int iG;z.Uint32List oG;z.Uint8List HH;z.Uint8List wG;z.Uint8List YH;z.Uint8List VH;z.Int32List WH;z.Uint8List nG;z.Uint8List mG;List<z.Int32List> PH;List<z.Int32List> QH;List<z.Int32List> RH;z.Int32List SH;z.Int32List UH;int MH;int XG=0;int YG=-1;int aG=0;int bG=0;z.Int32List cH;z.Int32List dH;z.Int32List eH;z.Int32List ZH;List<z.Uint8List> pG;int KH=0;int iH;static const int oB=6;static const int RC=50;static const int ZB=258;static const int hC=23;static const int JD=(2+(900000~/RC));static const int iC=4096;static const int gB=16;static const int PC=0;static const int QC=1;static const int KD=0;static const int LD=2;static const List<int> AC=const[619,720,127,481,931,816,813,233,566,247,985,724,205,454,863,491,741,242,949,214,733,859,335,708,621,574,73,654,730,472,419,436,278,496,867,210,399,680,480,51,878,465,811,169,869,675,611,697,867,561,862,687,507,283,482,129,807,591,733,623,150,238,59,379,684,877,625,169,643,105,170,607,520,932,727,476,693,425,174,647,73,122,335,530,442,853,695,249,445,515,909,545,703,919,874,474,882,500,594,612,641,801,220,162,819,984,589,513,495,799,161,604,958,533,221,400,386,867,600,782,382,596,414,171,516,375,682,485,911,276,98,553,163,354,666,933,424,341,533,870,227,730,475,186,263,647,537,686,600,224,469,68,770,919,190,373,294,822,808,206,184,943,795,384,383,461,404,758,839,887,715,67,618,276,204,918,873,777,604,560,951,160,578,722,79,804,96,409,713,940,652,934,970,447,318,353,859,672,112,785,645,863,803,350,139,93,354,99,820,908,609,772,154,274,580,184,79,626,630,742,653,282,762,623,680,81,927,626,789,125,411,521,938,300,821,78,343,175,128,250,170,774,972,275,999,639,495,78,352,126,857,956,358,619,580,124,737,594,701,612,669,112,134,694,363,992,809,743,168,974,944,375,748,52,600,747,642,182,862,81,344,805,988,739,511,655,814,334,249,515,897,955,664,981,649,113,974,459,893,228,433,837,553,268,926,240,102,654,459,51,686,754,806,760,493,403,415,394,687,700,946,670,656,610,738,392,760,799,887,653,978,321,576,617,626,502,894,679,243,440,680,879,194,572,640,724,926,56,204,700,707,151,457,449,797,195,791,558,945,679,297,59,87,824,713,663,412,693,342,606,134,108,571,364,631,212,174,643,304,329,343,97,430,751,497,314,983,374,822,928,140,206,73,263,980,736,876,478,430,305,170,514,364,692,829,82,855,953,676,246,369,970,294,750,807,827,150,790,288,923,804,378,215,828,592,281,565,555,710,82,896,831,547,261,524,462,293,465,502,56,661,821,976,991,658,869,905,758,745,193,768,550,608,933,378,286,215,979,792,961,61,688,793,644,986,403,106,366,905,644,372,567,466,434,645,210,389,550,919,135,780,773,635,389,707,100,626,958,165,504,920,176,193,713,857,265,203,50,668,108,645,990,626,197,510,357,358,850,858,364,936,638];}class yE{List<int> encode(List<int> g){input=new gC(g,byteOrder:LC);KC e=new KC(byteOrder:LC);HB=new BE(e);final int d=9;HB.bC(MB.MC);HB.FB(MB.FD+d);VG=100000*d-19;ZG=30;int c=0;int f=100000*d;cG=new z.Uint32List(f);dG=new z.Uint32List(f+OC);eG=new z.Uint32List(65537);gG=new z.Uint8List.view(dG.buffer);hG=new z.Uint16List.view(cG.buffer);jG=new z.Uint8List(256);kG=0;lG=0;mG=new z.Uint8List(JD);nG=new z.Uint8List(JD);pG=new List<z.Uint8List>(oB);qG=new List<z.Int32List>(oB);sG=new List<z.Int32List>(oB);for(int b=0;b<oB; ++b){pG[b]=new z.Uint8List(ZB);qG[b]=new z.Int32List(ZB);sG[b]=new z.Int32List(ZB);}tG=new List<z.Uint32List>(ZB);for(int b=0;b<ZB; ++b){tG[b]=new z.Uint32List(4);}while(!input.ZD){int h=vG();c=((c<<1)|(c>>31))&0xffffffff;c^= h;kG++ ;}HB.bC(MB.HD);HB.wC(c);HB.flush();return e.XD();}int vG(){wG=new z.Uint8List(256);xG=0;yG=MB.CD;zG=256;AH=0;while(xG<VG&&!input.ZD){BH(input.QB());}if(zG<256){CH();}zG=256;AH=0;yG=MB.ED(yG);DH();return yG;}void DH(){if(xG>0){EH();}if(xG>0){HB.bC(MB.GD);HB.wC(yG);HB.NB(1,0);HB.NB(24,lG);FH();GH();}}void FH(){z.Uint8List e=new z.Uint8List(256);IH=0;for(int c=0;c<256;c++ ){if(wG[c]!=0){jG[c]=IH;IH++ ;}}final int j=IH+1;LH=new z.Int32List(ZB);int d=0;int b=0;for(int c=0;c<IH;c++ ){e[c]=c;}for(int c=0;c<xG;c++ ){NH(d<=c);int f=cG[c]-1;if(f<0){f+= xG;}int i=jG[gG[f]];NH(i<IH);if(e[0]==i){b++ ;}else{if(b>0){b-- ;while(true){if(b&1!=0){hG[d]=QC;d++ ;LH[QC]++;}else{hG[d]=PC;d++ ;LH[PC]++;}if(b<2){break;}b=(b-2)~/2;}b=0;}int g=e[1];e[1]=e[0];int h=1;int k=i;while(k!=g){h++ ;int l=g;g=e[h];e[h]=l;}e[0]=g;f=h;hG[d]=f+1;d++ ;LH[f+1]++;}}if(b>0){b-- ;while(true){if(b&1!=0){hG[d]=QC;d++ ;LH[QC]++;}else{hG[d]=PC;d++ ;LH[PC]++;}if(b<2){break;}b=(b-2)~/2;}b=0;}hG[d]=j;d++ ;LH[j]++;OH=d;}void GH(){z.Uint16List l=new z.Uint16List(oB);z.Int32List dB=new z.Int32List(oB);int n=0;int o=IH+2;for(int f=0;f<oB;f++ ){for(int g=0;g<o;g++ ){pG[f][g]=ND;}}int h;NH(OH>0);if(OH<200){h=2;}else if(OH<600){h=3;}else if(OH<1200){h=4;}else if(OH<2400){h=5;}else{h=6;}int q=h;int cB=OH;int j=0;int i=0;while(q>0){int xB=cB~/q;int CB=0;i=j-1;while(CB<xB&&i<o-1){i++ ;CB+= LH[i];}if(i>j&&q!=h&&q!=1&&((h-q)%2==1)){CB-= LH[i];i-- ;}for(int g=0;g<o;g++ ){if(g>=j&&g<=i){pG[q-1][g]=FE;}else{pG[q-1][g]=ND;}}q-- ;j=i+1;cB-= CB;}for(int UB=0;UB<EE;UB++ ){for(int f=0;f<h;f++ ){dB[f]=0;}for(int f=0;f<h;f++ ){for(int g=0;g<o;g++ ){sG[f][g]=0;}}if(h==6){for(int g=0;g<o;g++ ){tG[g][0]=(pG[1][g]<<16)|pG[0][g];tG[g][1]=(pG[3][g]<<16)|pG[2][g];tG[g][2]=(pG[5][g]<<16)|pG[4][g];}}n=0;int zB=0;j=0;while(true){if(j>=OH){break;}int i=j+RC-1;if(i>=OH){i=OH-1;}for(int f=0;f<h;f++ ){l[f]=0;}if(h==6&&50==i-j+1){int OB=0;int LB=0;int KB=0;void e(int s){int v=hG[j+s];OB+= tG[v][0];LB+= tG[v][1];KB+= tG[v][2];}e(0);e(1);e(2);e(3);e(4);e(5);e(6);e(7);e(8);e(9);e(10);e(11);e(12);e(13);e(14);e(15);e(16);e(17);e(18);e(19);e(20);e(21);e(22);e(23);e(24);e(25);e(26);e(27);e(28);e(29);e(30);e(31);e(32);e(33);e(34);e(35);e(36);e(37);e(38);e(39);e(40);e(41);e(42);e(43);e(44);e(45);e(46);e(47);e(48);e(49);l[0]=OB&0xffff;l[1]=OB>>16;l[2]=LB&0xffff;l[3]=LB>>16;l[4]=KB&0xffff;l[5]=KB>>16;}else{for(int b=j;b<=i;b++ ){int v=hG[b];for(int f=0;f<h;f++ ){l[f]+=pG[f][v];}}}int RB=999999999;int w=-1;for(int f=0;f<h;f++ ){if(l[f]<RB){RB=l[f];w=f;}}zB+= RB;dB[w]++;mG[n]=w;n++ ;if(h==6&&50==i-j+1){void c(int s){sG[w][hG[j+s]]++;}c(0);c(1);c(2);c(3);c(4);c(5);c(6);c(7);c(8);c(9);c(10);c(11);c(12);c(13);c(14);c(15);c(16);c(17);c(18);c(19);c(20);c(21);c(22);c(23);c(24);c(25);c(26);c(27);c(28);c(29);c(30);c(31);c(32);c(33);c(34);c(35);c(36);c(37);c(38);c(39);c(40);c(41);c(42);c(43);c(44);c(45);c(46);c(47);c(48);c(49);}else{for(int b=j;b<=i;b++ ){sG[w][hG[b]]++;}}j=i+1;}for(int f=0;f<h;f++ ){aH(pG[f],sG[f],o,17);}}NH(h<8);NH(n<32768&&n<=(2+(900000~/RC)));z.Uint8List u=new z.Uint8List(oB);for(int b=0;b<h;b++ ){u[b]=b;}for(int b=0;b<n;b++ ){int jB=mG[b];int k=0;int EB=u[k];while(jB!=EB){k++ ;int lB=EB;EB=u[k];u[k]=lB;}u[0]=EB;nG[b]=k;}for(int f=0;f<h;f++ ){int DB=32;int BB=0;for(int b=0;b<o;b++ ){if(pG[f][b]>BB){BB=pG[f][b];}if(pG[f][b]<DB){DB=pG[f][b];}}NH(!(BB>17));NH(!(DB<1));bH(qG[f],pG[f],DB,BB,o);}z.Uint8List GB=new z.Uint8List(16);for(int b=0;b<16;b++ ){GB[b]=0;for(int k=0;k<16;k++ ){if(wG[b*16+k]!=0){GB[b]=1;}}}for(int b=0;b<16;b++ ){if(GB[b]!=0){HB.NB(1,1);}else{HB.NB(1,0);}}for(int b=0;b<16;b++ ){if(GB[b]!=0){for(int k=0;k<16;k++ ){if(wG[b*16+k]!=0){HB.NB(1,1);}else{HB.NB(1,0);}}}}HB.NB(3,h);HB.NB(15,n);for(int b=0;b<n;b++ ){for(int k=0;k<nG[b];k++ ){HB.NB(1,1);}HB.NB(1,0);}for(int f=0;f<h;f++ ){int t=pG[f][0];HB.NB(5,t);for(int b=0;b<o;b++ ){while(t<pG[f][b]){HB.NB(2,2);t++ ;}while(t>pG[f][b]){HB.NB(2,3);t-- ;}HB.NB(1,0);}}int r=0;j=0;while(true){if(j>=OH){break;}int i=j+RC-1;if(i>=OH){i=OH-1;}NH(mG[r]<h);if(h==6&&50==i-j+1){int PB;z.Uint8List yB=pG[mG[r]];z.Int32List EC=qG[mG[r]];void d(int s){PB=hG[j+s];HB.NB(yB[PB],EC[PB]);}d(0);d(1);d(2);d(3);d(4);d(5);d(6);d(7);d(8);d(9);d(10);d(11);d(12);d(13);d(14);d(15);d(16);d(17);d(18);d(19);d(20);d(21);d(22);d(23);d(24);d(25);d(26);d(27);d(28);d(29);d(30);d(31);d(32);d(33);d(34);d(35);d(36);d(37);d(38);d(39);d(40);d(41);d(42);d(43);d(44);d(45);d(46);d(47);d(48);d(49);}else{for(int b=j;b<=i;b++ ){HB.NB(pG[mG[r]][hG[b]],qG[mG[r]][hG[b]]);}}j=i+1;r++ ;}NH(r==n);}void aH(z.Uint8List KB,z.Int32List q,int k,int LB){z.Int32List b=new z.Int32List(ZB+2);z.Int32List e=new z.Int32List(ZB*2);z.Int32List h=new z.Int32List(ZB*2);int d;int i;for(int c=0;c<k;c++ ){e[c+1]=(q[c]==0?1:q[c])<<8;}void r(int n){int f=n;int l=b[f];while(e[l]<e[b[f>>1]]){b[f]=b[f>>1];f>>= 1;}b[f]=l;}void s(int n){int f=n;int l=b[f];while(true){int g=f<<1;if(g>d){break;}if(g<d&&e[b[g+1]]<e[b[g]]){g++ ;}if(e[l]<e[b[g]]){break;}b[f]=b[g];f=g;}b[f]=l;}int t(int OB)=>((OB)&0xffffff00);int u(int PB)=>((PB)&0x000000ff);int RB(int v,int w)=>((v)>(w)?(v):(w));int UB(int BB,int CB)=>(t(BB)+t(CB))|(1+RB(u(BB),u(CB)));while(true){i=k;d=0;b[0]=0;e[0]=0;h[0]=-2;for(int c=1;c<=k;c++ ){h[c]=-1;d++ ;b[d]=c;r(d);}NH(d<(ZB+2));while(d>1){int DB=b[1];b[1]=b[d];d-- ;s(1);int EB=b[1];b[1]=b[d];d-- ;s(1);i++ ;h[DB]=h[EB]=i;e[i]=UB(e[DB],e[EB]);h[i]=-1;d++ ;b[d]=i;r(d);}NH(i<(ZB*2));bool GB=false;for(int c=1;c<=k;c++ ){int j=0;int o=c;while(h[o]>=0){o=h[o];j++ ;}KB[c-1]=j;if(j>LB){GB=true;}}if(!GB){break;}for(int c=1;c<=k;c++ ){int j=e[c]>>8;j=1+(j~/2);e[c]=j<<8;}}}void bH(z.Int32List e,z.Uint8List f,int g,int h,int i){int c=0;for(int d=g;d<=h;d++ ){for(int b=0;b<i;b++ ){if(f[b]==d){e[b]=c;c++ ;}}c<<= 1;}}void EH(){if(xG<10000){fH(cG,dG,eG,xG);}else{int b=xG+OC;if(b&1!=0){b++ ;}z.Uint16List d=new z.Uint16List.view(gG.buffer,b);int c=ZG;if(c<1){c=1;}if(c>100){c=100;}int e=xG*((c-1)~/3);gH=e;hH(cG,gG,d,eG,xG);if(gH<0){fH(cG,dG,eG,xG);}}lG=-1;for(int b=0;b<xG;b++ ){if(cG[b]==0){lG=b;break;}}NH(lG!=-1);}void NH(bool b){if(!b){throw new wE('Data error');}}void fH(z.Uint32List j,z.Uint32List n,z.Uint32List k,int e){z.Int32List g=new z.Int32List(257);z.Int32List o=new z.Int32List(256);z.Uint8List q=new z.Uint8List.view(n.buffer);int r(int d)=>k[d>>5]|=(1<<(d&31));int CB(int d)=>k[d>>5]&=~(1<<(d&31));bool h(int d)=>(k[d>>5]&(1<<(d&31))!=0);int t(int d)=>k[(d)>>5];bool u(int d)=>((d)&0x01f)!=0;for(int b=0;b<257;b++ ){g[b]=0;}for(int b=0;b<e;b++ ){g[q[b]]++;}for(int b=0;b<256;b++ ){o[b]=g[b];}for(int b=1;b<257;b++ ){g[b]+=g[b-1];}for(int b=0;b<e;b++ ){int f=q[b];int c=g[f]-1;g[f]=c;j[c]=b;}int DB=2+(e~/32);for(int b=0;b<DB;b++ ){k[b]=0;}for(int b=0;b<256;b++ ){r(g[b]);}for(int b=0;b<32;b++ ){r(e+2*b);CB(e+2*b+1);}int s=1;while(true){int f=0;for(int b=0;b<e;b++ ){if(h(b)){f=b;}int c=j[b]-s;if(c<0){c+= e;}n[c]=f;}int v=0;int i=-1;while(true){int c=i+1;while(h(c)&&u(c)){c++ ;}if(h(c)){while(t(c)==0xffffffff){c+= 32;}while(h(c)){c++ ;}}int l=c-1;if(l>=e){break;}while(!h(c)&&u(c)){c++ ;}if(!h(c)){while(t(c)==0x00000000){c+= 32;}while(!h(c)){c++ ;}}i=c-1;if(i>=e){break;}if(i>l){v+= (i-l+1);jH(j,n,l,i);int w=-1;for(int b=l;b<=i;b++ ){int BB=n[j[b]];if(w!=BB){r(b);w=BB;}}}}s*= 2;if(s>e||v==0){break;}}int f=0;for(int b=0;b<e;b++ ){while(o[f]==0){f++ ;}o[f]--;q[j[b]]=f;}NH(f<256);}void jH(z.Uint32List b,z.Uint32List l,int LB,int OB){const int PB=10;const int r=100;z.Int32List v=new z.Int32List(r);z.Int32List w=new z.Int32List(r);int h=0;void o(int RB,int UB){v[h]=RB;w[h]=UB;h++ ;}int BB(int CB,int DB)=>((CB)<(DB))?(CB):(DB);void EB(s,t,GB){while(GB>0){int i=b[s];b[s]=b[t];b[t]=i;s++ ;t++ ;GB-- ;}}int u=0;o(LB,OB);while(h>0){NH(h<r-1);h-- ;int e=v[h];int f=w[h];if(f-e<PB){kH(b,l,e,f);continue;}u=((u*7621)+1)%32768;int KB=u%3;int q;if(KB==0){q=l[b[e]];}else if(KB==1){q=l[b[(e+f)>>1]];}else{q=l[b[f]];}int c=e;int j=e;int d=f;int k=f;while(true){while(true){if(c>d){break;}int g=l[b[c]]-q;if(g==0){int i=b[c];b[c]=b[j];b[j]=i;j++ ;c++ ;continue;}if(g>0){break;}c++ ;}while(true){if(c>d){break;}int g=l[b[d]]-q;if(g==0){int i=b[d];b[d]=b[k];b[k]=i;k-- ;d-- ;continue;}if(g<0){break;}d-- ;}if(c>d){break;}int i=b[c];b[c]=b[d];b[d]=i;c++ ;d-- ;}NH(d==c-1);if(k<j){continue;}int g=BB(j-e,c-j);EB(e,c-g,g);int n=BB(f-k,k-d);EB(c,f-n+1,n);g=e+c-j-1;n=f-(k-d)+1;if(g-e>f-n){o(e,g);o(n,f);}else{o(n,f);o(e,g);}}}void kH(z.Uint32List c,z.Uint32List g,int h,int e){if(h==e){return;}if(e-h>3){for(int d=e-4;d>=h;d-- ){int f=c[d];int i=g[f];int b;for(b=d+4;b<=e&&i>g[c[b]];b+= 4){c[b-4]=c[b];}c[b-4]=f;}}for(int d=e-1;d>=h;d-- ){int f=c[d];int i=g[f];int b;for(b=d+1;b<=e&&i>g[c[b]];b++ ){c[b-1]=c[b];}c[b-1]=f;}}void hH(z.Uint32List h,z.Uint8List f,z.Uint16List j,z.Uint32List e,int k){z.Int32List o=new z.Int32List(256);z.Uint8List q=new z.Uint8List(256);z.Int32List r=new z.Int32List(256);z.Int32List s=new z.Int32List(256);int GB(int KB)=>(eG[((KB)+1)<<8]-eG[(KB)<<8]);const int w=2097152;const int n=4292870143;for(int c=65536;c>=0;c-- ){e[c]=0;}int b=f[0]<<8;int c=k-1;for(;c>=3;c-= 4){j[c]=0;b=(b>>8)|((f[c])<<8);e[b]++;j[c-1]=0;b=(b>>8)|((f[c-1])<<8);e[b]++;j[c-2]=0;b=(b>>8)|((f[c-2])<<8);e[b]++;j[c-3]=0;b=(b>>8)|((f[c-3])<<8);e[b]++;}for(;c>=0;c-- ){j[c]=0;b=(b>>8)|((f[c])<<8);e[b]++;}for(c=0;c<OC;c++ ){f[k+c]=f[c];j[k+c]=0;}for(c=1;c<=65536;c++ ){e[c]+=e[c-1];}int d=f[0]<<8;c=k-1;for(;c>=3;c-= 4){d=(d>>8)|(f[c]<<8);b=e[d]-1;e[d]=b;h[b]=c;d=(d>>8)|(f[c-1]<<8);b=e[d]-1;e[d]=b;h[b]=c-1;d=(d>>8)|(f[c-2]<<8);b=e[d]-1;e[d]=b;h[b]=c-2;d=(d>>8)|(f[c-3]<<8);b=e[d]-1;e[d]=b;h[b]=c-3;}for(;c>=0;c-- ){d=(d>>8)|(f[c]<<8);b=e[d]-1;e[d]=b;h[b]=c;}for(c=0;c<=255;c++ ){q[c]=0;o[c]=c;}int i=1;do{i=3*i+1;}while(i<=256);do{i=i~/3;for(c=i;c<=255;c++ ){int LB=o[c];b=c;while(GB(o[b-i])>GB(LB)){o[b]=o[b-i];b=b-i;if(b<=(i-1)){break;}}o[b]=LB;}}while(i!=1);int RB=0;for(c=0;c<=255;c++ ){int g=o[c];for(b=0;b<=255;b++ ){if(b!=g){int u=(g<<8)+b;if((eG[u]&w)==0){int BB=eG[u]&n;int CB=(eG[u+1]&n)-1;if(CB>BB){lH(h,f,j,k,BB,CB,jC);RB+= (CB-BB+1);if(gH<0){return;}}}eG[u]|=w;}}NH(q[g]==0);for(b=0;b<=255;b++ ){r[b]=eG[(b<<8)+g]&n;s[b]=(eG[(b<<8)+g+1]&n)-1;}for(b=eG[g<<8]&n;b<r[g];b++ ){int l=h[b]-1;if(l<0)l+= k;int t=f[l];if(q[t]==0){h[r[t]++]=l;}}for(b=(eG[(g+1)<<8]&n)-1;b>s[g];b-- ){int l=h[b]-1;if(l<0){l+= k;}int t=f[l];if(q[t]==0){h[s[t]--]=l;}}NH((r[g]-1==s[g])||(r[g]==0&&s[g]==k-1));for(b=0;b<=255;b++ ){eG[(b<<8)+g]|=w;}q[g]=1;if(c<255){int OB=eG[g<<8]&n;int DB=(eG[(g+1)<<8]&n)-OB;int v=0;while((DB>>v)>65534){v++ ;}for(b=DB-1;b>=0;b-- ){int EB=h[OB+b];int PB=(b>>v)&0xffff;j[EB]=PB;if(EB<OC)j[EB+k]=PB;}NH(((DB-1)>>v)<=65535);}}}void lH(z.Uint32List b,z.Uint8List w,z.Uint16List iD,int yC,int xC,int cC,int dC){const EB=100;const eC=20;const EC=(jC+MD);z.Int32List dB=new z.Int32List(EB);z.Int32List cB=new z.Int32List(EB);z.Int32List UB=new z.Int32List(EB);z.Int32List j=new z.Int32List(3);z.Int32List k=new z.Int32List(3);z.Int32List l=new z.Int32List(3);int n=0;void BB(int yB,int xB,int zB){dB[n]=yB;cB[n]=xB;UB[n]=zB;n++ ;}int hD(int s,int e,int OB){if(s>e){int r=s;s=e;e=r;}if(e>OB){e=OB;if(s>e){e=s;}}return e;}void PB(int GB,int KB,int jB){while(jB>0){int r=b[GB];b[GB]=b[KB];b[KB]=r;GB++ ;KB++ ;jB-- ;}}int RB(int s,int e)=>((s)<(e))?(s):(e);int o(int q)=>(k[q]-j[q]);void LB(int q,int v){int DB=j[q];j[q]=j[v];j[v]=DB;DB=k[q];k[q]=k[v];k[v]=DB;DB=l[q];l[q]=l[v];l[v]=DB;}BB(xC,cC,dC);while(n>0){NH(n<EB-2);n-- ;int i=dB[n];int h=cB[n];int g=UB[n];if(h-i<eC||g>EC){mH(b,w,iD,yC,i,h,g);if(gH<0){return;}continue;}int lB=hD(w[b[i]+g],w[b[h]+g],w[b[(i+h)>>1]+g]);int c=i;int t=i;int d=h;int u=h;while(true){while(true){if(c>d){break;}int f=(w[b[c]+g])-lB;if(f==0){int r=b[c];b[c]=b[t];b[t]=r;t++ ;c++ ;continue;}if(f>0){break;}c++ ;}while(true){if(c>d){break;}int f=(w[b[d]+g])-lB;if(f==0){int r=b[d];b[d]=b[u];b[u]=r;u-- ;d-- ;continue;}if(f<0){break;}d-- ;}if(c>d){break;}int r=b[c];b[c]=b[d];b[d]=r;c++ ;d-- ;}NH(d==c-1);if(u<t){BB(i,h,g+1);continue;}int f=RB(t-i,c-t);PB(i,c-f,f);int CB=RB(h-u,u-d);PB(c,h-CB+1,CB);f=i+c-t-1;CB=h-(u-d)+1;j[0]=i;k[0]=f;l[0]=g;j[1]=CB;k[1]=h;l[1]=g;j[2]=f+1;k[2]=CB-1;l[2]=g+1;if(o(0)<o(1)){LB(0,1);}if(o(1)<o(2)){LB(1,2);}if(o(0)<o(1)){LB(0,1);}NH(o(0)>=o(1));NH(o(1)>=o(2));BB(j[0],k[0],l[0]);BB(j[1],k[1],l[1]);BB(j[2],k[2],l[2]);}}void mH(z.Uint32List c,z.Uint8List k,z.Uint16List l,int n,int i,int j,int g){int o=j-i+1;if(o<2){return;}const List<int> q=const[1,4,13,40,121,364,1093,3280,9841,29524,88573,265720,797161,2391484];int h=0;while(q[h]<o){h++ ;}h-- ;for(;h>=0;h-- ){int d=q[h];int e=i+d;while(true){if(e>j){break;}int f=c[e];int b=e;while(nH(c[b-d]+g,f+g,k,l,n)){c[b]=c[b-d];b=b-d;if(b<=(i+d-1)){break;}}c[b]=f;e++ ;if(e>j){break;}f=c[e];b=e;while(nH(c[b-d]+g,f+g,k,l,n)){c[b]=c[b-d];b=b-d;if(b<=(i+d-1)){break;}}c[b]=f;e++ ;if(e>j){break;}f=c[e];b=e;while(nH(c[b-d]+g,f+g,k,l,n)){c[b]=c[b-d];b=b-d;if(b<=(i+d-1)){break;}}c[b]=f;e++ ;if(gH<0){return;}}}}bool nH(int d,int e,z.Uint8List f,z.Uint16List i,int j){NH(d!=e);int b=f[d];int c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}d++ ;e++ ;int k=j+8;do{b=f[d];c=f[e];if(b!=c){return (b>c);}int g=i[d];int h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;b=f[d];c=f[e];if(b!=c){return (b>c);}g=i[d];h=i[e];if(g!=h){return (g>h);}d++ ;e++ ;if(d>=j){d-= j;}if(e>=j){e-= j;}k-= 8;gH-- ;}while(k>=0);return false;}void BH(int b){if(b!=zG&&AH==1){yG=MB.uB(zG,yG);wG[zG]=1;gG[xG]=zG;xG++ ;zG=b;}else{if(b!=zG||AH==255){if(zG<256){CH();}zG=b;AH=1;}else{AH++ ;}}}void CH(){for(int b=0;b<AH;b++ ){yG=MB.uB(zG,yG);}wG[zG]=1;switch (AH){case 1:gG[xG]=zG;xG++ ;break;case 2:gG[xG]=zG;xG++ ;gG[xG]=zG;xG++ ;break;case 3:gG[xG]=zG;xG++ ;gG[xG]=zG;xG++ ;gG[xG]=zG;xG++ ;break;default:wG[AH-4]=1;gG[xG]=zG;xG++ ;gG[xG]=zG;xG++ ;gG[xG]=zG;xG++ ;gG[xG]=zG;xG++ ;gG[xG]=AH-4;xG++ ;break;}}gC input;BE HB;int VG;int zG;int AH;int xG;int yG;int kG;int ZG;int gH;int lG;z.Uint32List cG;z.Uint32List dG;z.Uint32List eG;z.Uint8List gG;z.Uint8List wG;z.Uint16List hG;int IH;int OH;z.Int32List LH;z.Uint8List jG;List<z.Uint8List> pG;List<z.Int32List> qG;List<z.Int32List> sG;List<z.Uint32List> tG;z.Uint8List mG;z.Uint8List nG;static const int jC=2;static const int MD=12;static const int DE=18;static const int OC=(jC+MD+DE+2);static const int ZB=258;static const int PC=0;static const int QC=1;static const int oB=6;static const int RC=50;static const int EE=4;static const int FE=0;static const int ND=15;static const int JD=(2+(900000~/RC));}String OD(b)=>Uri.decodeComponent(b.replaceAll(r"\+",' '));String GE(DateTime f){var g=['Mon','Tue','Wed','Thi','Fri','Sat','Sun'];var h=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];var oH=(int c,int i){var d=c.toString();var e=i-d.length;return (e>0)?'${new List.filled(e,'0').join('')}${c}':d;};var b=f.toUtc();var j=oH(b.hour,2);var k=oH(b.minute,2);var l=oH(b.second,2);return '${g[b.weekday-1]}, ${b.day} ${h[b.month-1]} ${b.year} '+'${j}:${k}:${l} ${b.timeZoneName}';}String HE(String e){var h=new Map();var d=AB.document.cookie!=null?AB.document.cookie.split('; '):[] ;for(var b=0,f=d.length;b<f;b++ ){var c=d[b].split('=');var g=OD(c[0]);if(e==g){return c[1]!=null?OD(c[1]):null;}}return null;}void PD(String b,String c,{expires,path,domain,secure}){if(expires is num){expires=new DateTime.fromMillisecondsSinceEpoch(new DateTime.now().millisecondsSinceEpoch+expires*24*60*60*1000);}var d=([Uri.encodeComponent(b),'=',Uri.encodeComponent(c),expires!=null?'; expires='+GE(expires):'',path!=null?'; path='+path:'',domain!=null?'; domain='+domain:'',secure!=null&&secure==true?'; secure':''].join(''));AB.document.cookie=d;}abstract class QD{static const int SC=61;static const int IE=13;static const int JE=10;static const int KE=76;static const String LE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";static const String ME="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static const List<int> kC=const[-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-2,-2,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,62,-2,62,-2,63,52,53,54,55,56,57,58,59,60,61,-2,-2,-2,0,-2,-2,-2,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-2,-2,-2,-2,63,-2,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2];static String NE(List<int> f,[bool o=false,bool k=false]){int h=f.length;if(h==0){return "";}final String e=o?ME:LE;final int i=h.remainder(3);final int q=h-i;int j=((h~/3)*4)+((i>0)?4:0);if(k){j+= ((j-1)~/KE)<<1;}List<int> b=new List<int>(j);int c=0,g=0,l=0;while(g<q){int d=((f[g++ ]<<16)&0xFFFFFF)|((f[g++ ]<<8)&0xFFFFFF)|f[g++ ];b[c++ ]=e.codeUnitAt(d>>18);b[c++ ]=e.codeUnitAt((d>>12)&0x3F);b[c++ ]=e.codeUnitAt((d>>6)&0x3F);b[c++ ]=e.codeUnitAt(d&0x3f);if(k&& ++l==19&&c<j-2){b[c++ ]=IE;b[c++ ]=JE;l=0;}}if(i==1){int d=f[g];b[c++ ]=e.codeUnitAt(d>>2);b[c++ ]=e.codeUnitAt((d<<4)&0x3F);b[c++ ]=SC;b[c++ ]=SC;}else if(i==2){int d=f[g];int n=f[g+1];b[c++ ]=e.codeUnitAt(d>>2);b[c++ ]=e.codeUnitAt(((d<<4)|(n>>4))&0x3F);b[c++ ]=e.codeUnitAt((n<<2)&0x3F);b[c++ ]=SC;}return new String.fromCharCodes(b);}static List<int> OE(String c){int e=c.length;if(e==0){return new List<int>(0);}int j=0;for(int b=0;b<e;b++ ){int f=kC[c.codeUnitAt(b)];if(f<0){j++ ;if(f==-2){throw new FormatException('Invalid character: ${c[b]}');}}}if((e-j)%4!=0){throw new FormatException('''Size of Base 64 characters in Input
          must be a multiple of 4. Input: ${c}''');}int k=0;for(int b=e-1;b>=0;b-- ){int l=c.codeUnitAt(b);if(kC[l]>0)break;if(l==SC)k++ ;}int h=(((e-j)*6)>>3)-k;List<int> i=new List<int>(h);for(int b=0,d=0;d<h;){int g=0;for(int n=4;n>0;){int f=kC[c.codeUnitAt(b++ )];if(f>=0){g=((g<<6)&0xFFFFFF)|f;n-- ;}}i[d++ ]=g>>16;if(d<h){i[d++ ]=(g>>8)&0xFF;if(d<h)i[d++ ]=g&0xFF;}}return i;}}class RD{static String NE(List<int> b,{bool urlSafe: false,bool addLineSeparator: false}){return QD.NE(b,urlSafe,addLineSeparator);}static List<int> OE(String b){return QD.OE(b);}}